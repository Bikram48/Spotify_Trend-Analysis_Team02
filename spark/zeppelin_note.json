{"paragraphs":[{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2024-04-19T18:00:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1713549635455_-599452285","id":"20240419-180035_1550618133","dateCreated":"2024-04-19T18:00:35+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1697"},{"text":"%spark.pyspark \ns3_path = \"s3://spotifydatasetteam02/\"\ndf = spark.read.json(s3_path)","user":"anonymous","dateUpdated":"2024-04-19T17:38:22+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1713548267491_171357849","id":"20240412-215831_1765693125","dateCreated":"2024-04-19T17:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:169","dateFinished":"2024-04-19T17:40:10+0000","dateStarted":"2024-04-19T17:38:22+0000"},{"text":"%spark.pyspark\ndf.show()","user":"anonymous","dateUpdated":"2024-04-19T17:40:32+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+----------+------------+--------------+--------------------+\n|          album_name|             artists|                name|popularity|release_date|track_duration|            track_id|\n+--------------------+--------------------+--------------------+----------+------------+--------------+--------------------+\n|      11:11 (Deluxe)|[Chris Brown, Lil...|Freak (feat. Lil ...|        66|  2024-04-11|        247445|4FXL19CnaMVS1HzRF...|\n|      11:11 (Deluxe)|[Chris Brown, Lil...|Freak (feat. Lil ...|        66|  2024-04-11|        247445|4FXL19CnaMVS1HzRF...|\n|  Might Delete Later|[J. Cole, Ari Len...|Pricey (feat. Ari...|        79|  2024-04-05|        295146|2w5BtuWXISpB6NM4x...|\n|It Was Always You...|[Carin Leon, Leon...|It Was Always You...|        74|  2024-03-28|        209493|74XgsdImAXUs6VDcm...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n|Pirates & Parrots...|[Zac Brown Band, ...|Pirates & Parrots...|         0|  2024-04-19|        235792|5rqj68RF5smc7CmGE...|\n+--------------------+--------------------+--------------------+----------+------------+--------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1713548267498_-221523000","id":"20240412-215936_2031126806","dateCreated":"2024-04-19T17:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:170","dateFinished":"2024-04-19T17:40:34+0000","dateStarted":"2024-04-19T17:40:32+0000"},{"text":"%spark.pyspark\ndf.printSchema()","user":"anonymous","dateUpdated":"2024-04-19T17:40:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- album_name: string (nullable = true)\n |-- artists: array (nullable = true)\n |    |-- element: string (containsNull = true)\n |-- name: string (nullable = true)\n |-- popularity: long (nullable = true)\n |-- release_date: string (nullable = true)\n |-- track_duration: long (nullable = true)\n |-- track_id: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1713548267498_-2130668417","id":"20240412-220214_1874833339","dateCreated":"2024-04-19T17:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:171","dateFinished":"2024-04-19T17:40:54+0000","dateStarted":"2024-04-19T17:40:54+0000"},{"text":"%spark.pyspark\ndf.columns","user":"anonymous","dateUpdated":"2024-04-19T17:41:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['album_name', 'artists', 'name', 'popularity', 'release_date', 'track_duration', 'track_id']\n"}]},"apps":[],"jobName":"paragraph_1713548267499_-1462473929","id":"20240412-220229_1444272491","dateCreated":"2024-04-19T17:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:172","dateFinished":"2024-04-19T17:41:11+0000","dateStarted":"2024-04-19T17:41:11+0000"},{"text":"%spark.pyspark\nprint(\"Total number of row: \", df.count())","user":"anonymous","dateUpdated":"2024-04-19T17:42:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Total number of row:  4035\n"}]},"apps":[],"jobName":"paragraph_1713548267499_476890727","id":"20240412-220626_1387922650","dateCreated":"2024-04-19T17:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:173","dateFinished":"2024-04-19T17:43:06+0000","dateStarted":"2024-04-19T17:42:11+0000"},{"text":"%spark.pyspark\ndf = df.dropDuplicates()\ndf.count()","user":"anonymous","dateUpdated":"2024-04-19T17:43:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1713548579064_1219010595","id":"20240419-174259_1504939215","dateCreated":"2024-04-19T17:42:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1268","dateFinished":"2024-04-19T17:44:02+0000","dateStarted":"2024-04-19T17:43:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"487\n"}]}},{"text":"%spark.pyspark\nfrom pyspark.sql.functions import col, count, when\ndf.select([count(when(col(c).isNull(), c)).alias(c) for c in df.columns]).collect()","user":"anonymous","dateUpdated":"2024-04-19T17:50:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(album_name=0, artists=0, name=0, popularity=0, release_date=0, track_duration=0, track_id=0)]\n"}]},"apps":[],"jobName":"paragraph_1713548267500_770945208","id":"20240412-220709_1932652409","dateCreated":"2024-04-19T17:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174","dateFinished":"2024-04-19T17:48:17+0000","dateStarted":"2024-04-19T17:47:19+0000"},{"text":"%spark.pyspark\nfrom pyspark.sql.functions import col\ndf = df.withColumn(\"artists\", col(\"artists\")[0])\n","user":"anonymous","dateUpdated":"2024-04-19T17:53:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 2: df = df.withColumn(\"artists\", col(\"artists\")[0])\nTraceback (most recent call last):\n  File \"/usr/lib/spark/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/protocol.py\", line 328, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o155.withColumn.\n: org.apache.spark.sql.AnalysisException: Can't extract value from artists#136: need struct type but got string;\n\tat org.apache.spark.sql.catalyst.expressions.ExtractValue$.apply(complexTypeExtractors.scala:73)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$resolve(Analyzer.scala:944)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$resolve$2.apply(Analyzer.scala:945)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$resolve$2.apply(Analyzer.scala:945)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.org$apache$spark$sql$catalyst$trees$TreeNode$$applyFunctionIfChanged$1(TreeNode.scala:345)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$6.apply(TreeNode.scala:381)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:213)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:379)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:327)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveReferences$$resolve(Analyzer.scala:945)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$9$$anonfun$applyOrElse$35.apply(Analyzer.scala:1005)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$9$$anonfun$applyOrElse$35.apply(Analyzer.scala:1005)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$1.apply(QueryPlan.scala:105)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$1.apply(QueryPlan.scala:105)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:71)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpression$1(QueryPlan.scala:104)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:116)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1$2.apply(QueryPlan.scala:121)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.foreach(List.scala:392)\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n\tat scala.collection.immutable.List.map(List.scala:296)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$1(QueryPlan.scala:121)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$2.apply(QueryPlan.scala:126)\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:213)\n\tat org.apache.spark.sql.catalyst.plans.QueryPlan.mapExpressions(QueryPlan.scala:126)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$9.applyOrElse(Analyzer.scala:1005)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$$anonfun$apply$9.applyOrElse(Analyzer.scala:948)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$apply$1.apply(AnalysisHelper.scala:90)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$apply$1.apply(AnalysisHelper.scala:90)\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:71)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:89)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.apply(Analyzer.scala:948)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveReferences$.apply(Analyzer.scala:793)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1$$anonfun$2.apply(RuleExecutor.scala:92)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1$$anonfun$2.apply(RuleExecutor.scala:92)\n\tat org.apache.spark.sql.execution.QueryExecutionMetrics$.withMetrics(QueryExecutionMetrics.scala:141)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:91)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:88)\n\tat scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:124)\n\tat scala.collection.immutable.List.foldLeft(List.scala:84)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:88)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:80)\n\tat scala.collection.immutable.List.foreach(List.scala:392)\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:80)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:164)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$execute$1.apply(Analyzer.scala:156)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$execute$1.apply(Analyzer.scala:156)\n\tat org.apache.spark.sql.catalyst.analysis.AnalysisContext$.withLocalMetrics(Analyzer.scala:104)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:155)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$executeAndCheck$1.apply(Analyzer.scala:126)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$executeAndCheck$1.apply(Analyzer.scala:125)\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:201)\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:125)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:76)\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:74)\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:66)\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:79)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:3418)\n\tat org.apache.spark.sql.Dataset.select(Dataset.scala:1342)\n\tat org.apache.spark.sql.Dataset.withColumns(Dataset.scala:2260)\n\tat org.apache.spark.sql.Dataset.withColumn(Dataset.scala:2227)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:750)\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-9094444130705321900.py\", line 380, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 2, in <module>\n  File \"/usr/lib/spark/python/lib/pyspark.zip/pyspark/sql/dataframe.py\", line 1999, in withColumn\n    return DataFrame(self._jdf.withColumn(colName, col._jc), self.sql_ctx)\n  File \"/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 1257, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/usr/lib/spark/python/lib/pyspark.zip/pyspark/sql/utils.py\", line 69, in deco\n    raise AnalysisException(s.split(': ', 1)[1], stackTrace)\npyspark.sql.utils.AnalysisException: \"Can't extract value from artists#136: need struct type but got string;\"\n"}]},"apps":[],"jobName":"paragraph_1713548267501_-593689867","id":"20240412-222644_763510529","dateCreated":"2024-04-19T17:37:47+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:175","dateFinished":"2024-04-19T17:52:38+0000","dateStarted":"2024-04-19T17:52:38+0000"},{"text":"%spark.pyspark\ndf.select(\"artists\").show()","user":"anonymous","dateUpdated":"2024-04-19T17:53:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+\n|       artists|\n+--------------+\n|        Future|\n|       Beyoncé|\n|        Future|\n|   girl in red|\n|  Benson Boone|\n|    Nate Smith|\n|      GloRilla|\n|Chayce Beckham|\n|   girl in red|\n|          Feid|\n| Cole Swindell|\n|Chayce Beckham|\n|       Beyoncé|\n|          TINI|\n|      Bizarrap|\n|       J. Cole|\n|        ERNEST|\n|   Marcus King|\n|   Marcus King|\n|Lizzy McAlpine|\n+--------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1713548267501_-1027916662","id":"20240412-231857_124509403","dateCreated":"2024-04-19T17:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:176","dateFinished":"2024-04-19T17:54:30+0000","dateStarted":"2024-04-19T17:53:35+0000"},{"text":"%spark.pyspark\ndf1.printSchema()","user":"anonymous","dateUpdated":"2024-04-19T17:37:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Album: string (nullable = true)\n |-- Artist: string (nullable = true)\n |-- Track ID: string (nullable = true)\n |-- Track Name: string (nullable = true)\n |-- Track URI: string (nullable = true)\n |-- acousticness: double (nullable = true)\n |-- danceability: double (nullable = true)\n |-- popularity: long (nullable = true)\n |-- speechiness: double (nullable = true)\n |-- valence: double (nullable = true)\n |-- liveness: double (nullable = true)\n |-- instrumentalness: double (nullable = true)\n |-- mode: long (nullable = true)\n |-- energy: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1713548267502_-1418506609","id":"20240412-232053_874389938","dateCreated":"2024-04-19T17:37:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:177"},{"text":"%spark.pyspark\nfrom pyspark.sql.functions import col, isnan, when, count\nmissing_counts = df1.select([count(when(isnan(c) | col(c).isNull(), c)).alias(c) for c in df1.columns])\n\n# Display missing value counts\nmissing_counts.show()\n","user":"anonymous","dateUpdated":"2024-04-19T17:37:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+------+--------+----------+---------+------------+------------+----------+-----------+-------+--------+----------------+----+------+\n|Album|Artist|Track ID|Track Name|Track URI|acousticness|danceability|popularity|speechiness|valence|liveness|instrumentalness|mode|energy|\n+-----+------+--------+----------+---------+------------+------------+----------+-----------+-------+--------+----------------+----+------+\n|    0|     0|       0|         0|        0|           0|           0|       154|          0|      0|       0|               0|   0|     0|\n+-----+------+--------+----------+---------+------------+------------+----------+-----------+-------+--------+----------------+----+------+\n\n"}]},"apps":[],"jobName":"paragraph_1713548267502_183851190","id":"20240413-000505_543088758","dateCreated":"2024-04-19T17:37:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:178"},{"text":"%spark.pyspark\nfrom pyspark.sql.functions import regexp_replace, col\n\ncols = [\"album_name\", \"name\"]\nfor col_name in cols:\n    df = df.withColumn(col_name, regexp_replace(col(col_name), \",\", \"\"))\n\ndf.show()","user":"anonymous","dateUpdated":"2024-04-19T17:59:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1713548267503_-74243589","id":"20240413-000748_1025213824","dateCreated":"2024-04-19T17:37:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:179","dateFinished":"2024-04-19T18:00:10+0000","dateStarted":"2024-04-19T17:59:14+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------+--------------------+----------+------------+--------------+--------------------+\n|          album_name|       artists|                name|popularity|release_date|track_duration|            track_id|\n+--------------------+--------------+--------------------+----------+------------+--------------+--------------------+\n|WE STILL DON'T TR...|        Future|  Always Be My Fault|        71|  2024-04-12|        246666|1FIwzmULOKGNmo5bO...|\n|   Ehhthang Ehhthang|      GloRilla|Finesse Da Glo (f...|        63|  2024-04-05|        142702|1nKgk560ybSt7eZLt...|\n|Endiamantado / En...|      Bizarrap|     Entre las de 20|        82|  2024-04-03|        168511|3184c0tjCakg9oaNZ...|\n|WE STILL DON'T TR...|        Future|       Drink N Dance|        76|  2024-04-12|        220626|0SdpzQRdK8BdSV57r...|\n|I'M DOING IT AGAI...|   girl in red| DOING IT AGAIN BABY|        58|  2024-04-12|        145272|6LK3rmeoEfVYtH8B6...|\n|  Might Delete Later|       J. Cole|Trae The Truth in...|        76|  2024-04-05|        255440|4E2fOeF5A6onC10Ot...|\n|Fireworks & Rolle...|  Benson Boone|          Hello Love|        69|  2024-04-05|        208420|6VyWsk3qiz8NmHUEy...|\n|   Through the Smoke|    Nate Smith| Here's To Hometowns|        54|  2024-04-05|        221423|2N9Z9TGnBeOYrjtyc...|\n|I'M DOING IT AGAI...|   girl in red|            Too Much|        61|  2024-04-12|        183473|49oNAMh9RBScs4HXZ...|\n|         Mood Swings|   Marcus King|F*ck My Life Up A...|        50|  2024-04-05|        258626|0Jw0GvrJl8QIvY28w...|\n|   MANIFESTING 20-05|          Feid|         No Digas Na|        73|  2024-04-10|        208386|2iPoYcC5x7gylwRyC...|\n|          Bad For Me|Chayce Beckham|          Bad For Me|        41|  2024-04-05|        204720|0c7fhqwyv9bvdOhHB...|\n|   un mechón de pelo|          TINI|                bien|        64|  2024-04-11|        172909|7iqWxH5QBMBKOPV8P...|\n|               Older|Lizzy McAlpine|              Vortex|        65|  2024-04-05|        343360|7ySoma7tOtUTPSELi...|\n|               Older|Lizzy McAlpine|             Staying|        65|  2024-04-05|        151653|3tcCT8WhAIeRW2Ey9...|\n|              Strong| Tyler Hubbard|              Strong|        38|  2024-04-12|        176426|2OSQ9bmwVST63xuoq...|\n|       COWBOY CARTER|       Beyoncé|          SPAGHETTII|        83|  2024-03-29|        158477|5UcUppRaEIBMIHXiU...|\n| NASHVILLE TENNESSEE|        ERNEST|Never Said I Love...|        46|  2024-04-12|        254662|3TNVeSrxyXQoHmwmj...|\n|          Bad For Me|Chayce Beckham|Drink You Off My ...|        41|  2024-04-05|        211995|4QLQakIfGYdSBtkTK...|\n|       Forever To Me| Cole Swindell|         3 Feet Tall|        43|  2024-04-12|        222906|2j3HIMVaepfCQtS6E...|\n+--------------------+--------------+--------------------+----------+------------+--------------+--------------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%spark.pyspark\ns3_path = \"s3://spotifyoutputdataset/output/\"\ndf_single_partition = df.coalesce(1)\n\ndf_single_partition.write.csv(s3_path, header=True)","user":"anonymous","dateUpdated":"2024-04-19T18:04:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1713549414322_525697355","id":"20240419-175654_1533971268","dateCreated":"2024-04-19T17:56:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1562","dateFinished":"2024-04-19T18:05:32+0000","dateStarted":"2024-04-19T18:04:33+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2024-04-19T18:04:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1713549867205_233094411","id":"20240419-180427_1287726554","dateCreated":"2024-04-19T18:04:27+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1851"}],"name":"SpotifyAnalysisNote","id":"2JW57BD6Z","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}